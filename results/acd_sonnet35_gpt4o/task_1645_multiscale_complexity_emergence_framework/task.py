import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        domains = [
            "Biological Systems",
            "Social Networks",
            "Economic Markets",
            "Urban Development",
            "Technological Innovation",
            "Environmental Ecosystems"
        ]
        scales = [
            "Micro",
            "Meso",
            "Macro"
        ]
        tasks = {}
        for i in range(1, 3):
            tasks[str(i)] = {
                "domain": random.choice(domains),
                "scale": random.choice(scales)
            }
        return tasks

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design a theoretical framework for analyzing and predicting the emergence of complex systems across different scales and domains, with a focus on {t['domain']} at the {t['scale']} scale. Your framework should integrate concepts from complexity theory, network science, and domain-specific knowledge. Your response should include:

1. Theoretical Foundation (300-350 words):
   a) Describe the key components of your framework for analyzing complex system emergence.
   b) Explain how you integrate principles from complexity theory and network science.
   c) Discuss how your framework accounts for scale-specific characteristics in {t['domain']}.
   d) Explain how your framework can be generalized to other domains and scales.

2. Mathematical Formulation (250-300 words):
   a) Provide the core equations or algorithms that form the basis of your framework.
   b) Explain the significance of each component in your mathematical formulation.
   c) Describe how your formulation captures the dynamics of complex system emergence.

3. Predictive Model (200-250 words):
   a) Outline a predictive model based on your framework that can forecast emergent properties or behaviors in {t['domain']} at the {t['scale']} scale.
   b) Explain how your model handles uncertainty and stochastic processes.
   c) Describe how you would validate your model against real-world data.

4. Cross-domain Application (200-250 words):
   a) Demonstrate how your framework could be applied to a different domain at a different scale.
   b) Discuss the adjustments needed to adapt your framework to this new context.
   c) Compare and contrast the expected emergent properties in both domains.

5. Implications and Insights (150-200 words):
   a) Discuss the potential implications of your framework for our understanding of complex systems.
   b) Propose at least two novel insights or hypotheses generated by your framework.
   c) Explain how these insights might influence research or practice in relevant fields.

6. Limitations and Future Directions (150-200 words):
   a) Identify potential limitations or challenges in implementing your framework.
   b) Suggest at least two ways to extend or refine your approach in future research.
   c) Discuss how emerging technologies or methodologies might enhance your framework.

Ensure your response demonstrates a deep understanding of complexity theory, network science, and the specific domain. Be innovative in your approach while maintaining scientific rigor and plausibility. Use appropriate technical terminology and provide clear explanations for complex concepts.

Format your response with clear headings for each section. Your total response should be between 1250-1550 words. Please adhere to the structure outlined above, using the provided headings and subheadings."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            "The response includes all six required sections with appropriate content and word counts.",
            "The theoretical framework demonstrates a deep understanding of complexity theory, network science, and the specified domain.",
            "The mathematical formulation is coherent and relevant to the framework described.",
            "The predictive model is logically derived from the framework and specifically addresses the given domain ({t['domain']}) at the given scale ({t['scale']}).",
            "The cross-domain application demonstrates the framework's versatility and adaptability.",
            "The implications, insights, limitations, and future directions are thoughtfully considered and well-reasoned.",
            "The overall response shows creativity, interdisciplinary knowledge integration, and rigorous scientific thinking.",
            "The response adheres to the specified structure with clear headings and subheadings."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
