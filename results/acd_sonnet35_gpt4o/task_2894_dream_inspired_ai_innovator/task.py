import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        problem_domains = [
            {"domain": "Urban Planning", "challenge": "Sustainable city design"},
            {"domain": "Healthcare", "challenge": "Personalized medicine optimization"},
            {"domain": "Education", "challenge": "Adaptive learning systems"},
            {"domain": "Environmental Conservation", "challenge": "Ecosystem restoration"},
            {"domain": "Space Exploration", "challenge": "Long-term space habitat design"}
        ]
        return {
            "1": random.choice(problem_domains),
            "2": random.choice(problem_domains)
        }

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design an AI system inspired by the cognitive processes of dreaming to generate innovative solutions for {t['challenge']} in the domain of {t['domain']}. Your response should include the following sections:

1. Dream-Inspired AI Architecture (250-300 words):
   a) Describe the key components and mechanisms of your AI system.
   b) Explain how your design incorporates principles from dream cognition research.
   c) Discuss how your architecture addresses creative problem-solving.
   d) Include at least one innovative feature that distinguishes your model from traditional AI systems.

2. Problem-Solving Methodology (200-250 words):
   a) Propose a methodology for how your AI system would approach {t['challenge']}.
   b) Describe how your model would process and represent information related to the problem domain.
   c) Explain how the dream-inspired features contribute to generating innovative solutions.

3. Potential Solutions and Evaluation (200-250 words):
   a) Provide two example solutions that your AI system might generate for {t['challenge']}.
   b) Explain how these solutions demonstrate creativity and innovation.
   c) Propose criteria for evaluating the effectiveness and novelty of the generated solutions.

4. Implications for AI and Cognitive Science (200-250 words):
   a) Discuss how your model could contribute to our understanding of human creativity and problem-solving.
   b) Explore potential applications of your architecture in other domains or industries.
   c) Propose an experiment to test a hypothesis about dream-inspired cognition using your model.

5. Ethical Considerations and Limitations (150-200 words):
   a) Identify two potential ethical implications or challenges arising from your model's design or application.
   b) Discuss any limitations of your approach and potential areas for improvement.
   c) Propose guidelines or safeguards to address these ethical concerns and limitations.

Ensure your response demonstrates a deep understanding of both cognitive science and AI principles, particularly in relation to dream cognition and creative problem-solving. Use technical terminology appropriately and provide explanations where necessary. Be creative in your approach while maintaining scientific plausibility.

Format your response using clear headings for each section. Your total response should be between 1000-1250 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            "The response demonstrates a thorough understanding of dream cognition and its potential application in AI systems.",
            "The AI architecture design is innovative, detailed, and scientifically plausible, incorporating principles from dream research.",
            "The problem-solving methodology is well-explained and appropriate for the given challenge in the specified domain.",
            "The potential solutions generated by the AI system are creative, relevant, and demonstrate how dream-inspired cognition could lead to innovation.",
            "The implications for AI and cognitive science are thoughtfully explored, with a plausible experiment proposed.",
            "Ethical considerations and limitations are addressed comprehensively, with appropriate safeguards suggested.",
            "The response shows strong interdisciplinary reasoning, combining insights from cognitive science, AI, and the specific problem domain.",
            "The writing is clear, well-structured, and adheres to the specified format and word limits for each section."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
