import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        cognitive_biases = [
            {
                "name": "Confirmation Bias",
                "description": "The tendency to search for, interpret, favor, and recall information in a way that confirms or supports one's prior beliefs or values."
            },
            {
                "name": "Availability Heuristic",
                "description": "The tendency to overestimate the likelihood of events with greater 'availability' in memory, which can be influenced by how recent the memories are or how unusual or emotionally charged they may be."
            }
        ]
        return {str(i+1): bias for i, bias in enumerate(cognitive_biases)}

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design an AI system that generates narratives by simulating human cognitive processes, focusing on the {t['name']}. Then, use your system to create a short story that demonstrates this cognitive bias in action. Your response should include:

1. AI System Design (250-300 words):
   a) Describe the key components of your AI narrative generation system.
   b) Explain how your system models and incorporates the {t['name']}.
   c) Discuss how your system simulates other relevant cognitive processes for narrative creation.
   d) Include a simple diagram or flowchart illustrating your system's architecture.

2. Cognitive Model Integration (200-250 words):
   a) Explain in detail how your system models the {t['name']}.
   b) Discuss how this cognitive bias influences the narrative generation process.
   c) Describe any challenges in implementing this cognitive bias in an AI system and how you addressed them.

3. Narrative Generation Process (200-250 words):
   a) Outline the steps your AI system takes to generate a narrative incorporating the {t['name']}.
   b) Explain how the system ensures the narrative is coherent and engaging while demonstrating the cognitive bias.
   c) Discuss any literary techniques or structures your system employs to enhance the narrative.

4. Generated Short Story (300-350 words):
   Present a short story generated by your AI system that demonstrates the {t['name']} in action. The story should have a clear beginning, middle, and end, and should effectively illustrate how the cognitive bias influences the characters' thoughts, decisions, or actions.

5. Analysis of Generated Story (200-250 words):
   a) Analyze how the {t['name']} is manifested in the generated story.
   b) Discuss the literary elements used to convey the cognitive bias.
   c) Explain how the story reflects the AI system's understanding of human cognition and behavior.

6. Ethical Considerations and Limitations (150-200 words):
   a) Discuss potential ethical implications of using AI to simulate cognitive biases in storytelling.
   b) Address any limitations of your approach in accurately representing human cognition and creativity.
   c) Suggest guidelines for responsible use of such AI-generated narratives.

Ensure your response demonstrates a deep understanding of cognitive science, creative writing techniques, and AI technologies. Be innovative in your approach while maintaining scientific and narrative plausibility. Use appropriate terminology from all relevant fields and provide explanations where necessary.

Format your response with clear headings for each section. Your total response should be between 1300-1600 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response demonstrates a clear understanding of the {t['name']} and how it influences human cognition and behavior",
            "The AI system design is innovative, coherent, and plausibly incorporates cognitive science principles",
            "The generated short story effectively illustrates the specified cognitive bias in action",
            "The analysis of the generated story shows insight into both cognitive science and literary techniques",
            "The response addresses ethical considerations and limitations of AI-generated narratives based on cognitive biases"
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
