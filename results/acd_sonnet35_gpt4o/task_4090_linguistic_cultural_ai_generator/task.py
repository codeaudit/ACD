import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        linguistic_features = [
            "a language with no word for 'no' or negation",
            "a language where the future tense is more complex than the past tense",
            "a language with a base-6 number system",
            "a language where the speaker's social status affects verb conjugation",
            "a language with no distinction between 'to have' and 'to be'",
            "a language where color words are based on texture rather than hue",
            "a language with grammatical gender based on shape rather than biological sex",
            "a language where all verbs are in passive voice by default"
        ]
        return {
            "1": {"linguistic_feature": random.choice(linguistic_features)},
            "2": {"linguistic_feature": random.choice(linguistic_features)}
        }

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design an AI system that generates and analyzes fictional cultural practices based on given linguistic features, then use it to create and explain a specific cultural scenario. The linguistic feature to focus on is: {t['linguistic_feature']}.

Your response should include the following sections:

1. AI System Architecture (250-300 words):
   a) Describe the key components of your AI system for generating and analyzing cultural practices.
   b) Explain how the system incorporates linguistic knowledge and cultural anthropology principles.
   c) Detail the data sources or knowledge bases the system would use.
   d) Discuss any machine learning models or algorithms employed in the system.

2. Linguistic-Cultural Mapping Process (200-250 words):
   a) Explain how your system maps linguistic features to potential cultural practices.
   b) Describe the logic or rules used to ensure cultural coherence and plausibility.
   c) Discuss how the system handles the creative aspects of cultural generation.

3. Generated Cultural Scenario (250-300 words):
   Present a specific cultural scenario generated by your AI system based on the given linguistic feature. Include:
   a) A brief description of the fictional culture's key characteristics.
   b) At least three unique cultural practices or traditions directly influenced by the linguistic feature.
   c) An explanation of how these practices logically follow from the linguistic feature.

4. Anthropological Analysis (200-250 words):
   a) Provide an in-depth analysis of how the generated culture reflects the given linguistic feature.
   b) Discuss potential societal implications of the generated cultural practices.
   c) Compare aspects of the generated culture to real-world cultures or linguistic phenomena.

5. Evaluation and Limitations (150-200 words):
   a) Propose methods to evaluate the plausibility and internal consistency of the generated cultures.
   b) Discuss potential limitations or biases in your AI system's approach.
   c) Suggest areas for future improvement or expansion of the system.

6. Ethical Considerations (100-150 words):
   a) Discuss ethical implications of using AI to generate and analyze fictional cultures.
   b) Address potential concerns about cultural appropriation or stereotyping.
   c) Propose guidelines for responsible use of such technology in anthropological or linguistic research.

Ensure your response demonstrates a deep understanding of linguistics, cultural anthropology, and AI system design. Be creative and speculative in your approach while maintaining scientific plausibility. Use appropriate terminology throughout your response.

Format your response with clear headings for each section. Your total response should be between 1150-1450 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            "The response must include all six required sections with appropriate content for each.",
            "The AI system design must be plausible and demonstrate understanding of AI, linguistics, and cultural anthropology.",
            "The generated cultural scenario must be creative, coherent, and clearly linked to the given linguistic feature.",
            "The anthropological analysis must be insightful and demonstrate understanding of cultural dynamics.",
            "The response must address ethical considerations and limitations of the proposed system.",
            "The overall response must be well-structured, use appropriate terminology, and demonstrate interdisciplinary knowledge integration."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
