import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        tasks = [
            {
                "cognitive_process": "working memory",
                "musical_element": "rhythm",
                "linguistic_feature": "syntax"
            },
            {
                "cognitive_process": "attention",
                "musical_element": "harmony",
                "linguistic_feature": "semantics"
            },
            {
                "cognitive_process": "emotion processing",
                "musical_element": "melody",
                "linguistic_feature": "pragmatics"
            },
            {
                "cognitive_process": "decision making",
                "musical_element": "timbre",
                "linguistic_feature": "phonology"
            }
        ]
        return {str(i+1): task for i, task in enumerate(random.sample(tasks, 2))}

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design a system that synthesizes a new form of communication by integrating principles of neurolinguistics, music theory, and artificial intelligence. Your system should focus on the cognitive process of {t['cognitive_process']}, the musical element of {t['musical_element']}, and the linguistic feature of {t['linguistic_feature']}. Then, use your system to compose and analyze an expressive 'neuro-musical' phrase.

A 'neuro-musical' phrase is a novel form of expression that combines elements of language and music, designed to engage specific cognitive processes. It goes beyond traditional language or musical notation to create a unique, interdisciplinary form of communication. For example, a neuro-musical phrase might use rhythmic patterns to reinforce syntactic structures, engaging working memory in a novel way.

Your response should include the following sections, with each section clearly labeled:

1. System Architecture (300-350 words):
   a) Describe the key components of your neuro-musical language synthesis system.
   b) Explain how your system integrates the specified cognitive process, musical element, and linguistic feature.
   c) Detail how artificial intelligence is used to facilitate the synthesis and analysis of neuro-musical phrases.
   d) Discuss any novel approaches or algorithms used in your design.

2. Neurolinguistic-Musical Framework (250-300 words):
   a) Explain how your system represents and processes the specified cognitive process in the context of language and music.
   b) Describe how the chosen musical element is integrated into the linguistic structure.
   c) Detail how the system handles the interplay between the cognitive process, musical element, and linguistic feature.

3. Composition Process (200-250 words):
   a) Outline the steps involved in composing a neuro-musical phrase using your system.
   b) Explain how the system ensures the phrase is expressive and meaningful.
   c) Provide a concrete example of a short neuro-musical phrase generated by your system, including its structure and intended meaning.

4. Analysis Methodology (200-250 words):
   a) Describe how your system would analyze a given neuro-musical phrase.
   b) Explain the key features or patterns your system looks for during analysis.
   c) Discuss how the analysis could provide insights into the composer's cognitive state or communicative intent.

5. Potential Applications (150-200 words):
   a) Propose two potential applications of your neuro-musical language synthesis system.
   b) Explain how these applications could advance our understanding of cognition, language, or music.

6. Evaluation and Challenges (150-200 words):
   a) Propose methods for evaluating the effectiveness and expressiveness of your system's neuro-musical phrases.
   b) Discuss potential challenges or limitations in implementing and using your system.
   c) Suggest areas for future research or improvement in neuro-musical language synthesis.

Ensure your response demonstrates a deep understanding of neuroscience, linguistics, music theory, and artificial intelligence. Be innovative in your approach while maintaining scientific plausibility. Use appropriate technical terminology and provide clear explanations for complex concepts.

Your response should be structured with clear headings for each section, following the numbering provided above. The total word count for your response should be between 1250-1550 words. Please adhere to this limit while providing comprehensive answers for each section."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response should integrate the cognitive process of {t['cognitive_process']}, the musical element of {t['musical_element']}, and the linguistic feature of {t['linguistic_feature']}.",
            "The system design should demonstrate a deep understanding of neuroscience, linguistics, music theory, and artificial intelligence.",
            "The response should include all required sections: System Architecture, Neurolinguistic-Musical Framework, Composition Process, Analysis Methodology, Potential Applications, and Evaluation and Challenges.",
            "The proposed system should be innovative while maintaining scientific plausibility.",
            "The response should provide clear explanations for complex concepts and use appropriate technical terminology.",
            "The response must include a concrete example of a neuro-musical phrase generated by the system.",
            "The total response should be between 1250-1550 words.",
            "The response should be structured with clear headings for each section as specified in the instructions."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
