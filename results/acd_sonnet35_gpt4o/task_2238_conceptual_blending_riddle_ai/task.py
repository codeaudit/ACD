import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        concepts = [
            "time", "space", "light", "darkness", "water", "fire",
            "earth", "air", "life", "death", "knowledge", "ignorance"
        ]
        tasks = []
        for _ in range(2):
            concept1, concept2 = random.sample(concepts, 2)
            tasks.append({
                "concept1": concept1,
                "concept2": concept2
            })
        return {str(i+1): task for i, task in enumerate(tasks)}

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design an AI system that generates and solves riddles based on conceptual blending theory, then use it to create and solve a complex riddle blending the concepts of {t['concept1']} and {t['concept2']}. Your response should include:

1. Conceptual Blending Theory Overview (150-200 words):
   a) Explain the key principles of conceptual blending theory.
   b) Discuss how it relates to human cognition and creativity.
   c) Provide a simple example of conceptual blending.

2. AI System Design (250-300 words):
   a) Describe the architecture of your AI system for generating and solving riddles.
   b) Explain how it implements conceptual blending.
   c) Detail the key components, including any machine learning models or knowledge bases.
   d) Discuss how the system handles the creative aspects of riddle generation and solving.

3. Riddle Generation Process (200-250 words):
   a) Explain how your system generates riddles using conceptual blending.
   b) Describe the steps involved in blending {t['concept1']} and {t['concept2']}.
   c) Discuss how the system ensures the riddles are both challenging and solvable.

4. Generated Riddle (50-100 words):
   Present a riddle generated by your AI system that blends {t['concept1']} and {t['concept2']}. The riddle should be creative, challenging, and solvable.

5. Riddle Solution (150-200 words):
   a) Provide the solution to the generated riddle.
   b) Explain the conceptual blend used in the riddle.
   c) Describe how your AI system would approach solving this riddle.

6. Evaluation and Limitations (150-200 words):
   a) Propose methods to evaluate the creativity and quality of the generated riddles.
   b) Discuss potential limitations of your AI system.
   c) Suggest areas for future improvement or research.

7. Ethical and Cognitive Implications (100-150 words):
   a) Discuss the ethical implications of AI systems that can perform creative cognitive tasks.
   b) Explore how this technology might impact our understanding of human creativity and cognition.

Ensure your response demonstrates a deep understanding of conceptual blending theory, AI system design, and creative problem-solving. Be innovative in your approach while maintaining scientific plausibility. Use appropriate terminology from cognitive science and AI throughout your response.

Format your response with clear headings for each section. Your total response should be between 1050-1400 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            "The response must include a clear explanation of conceptual blending theory",
            "The AI system design should be well-defined and incorporate conceptual blending principles",
            "The riddle generation process should be clearly explained and involve blending the two given concepts",
            "A creative and challenging riddle blending the two concepts must be presented",
            "A plausible solution to the riddle should be provided, along with an explanation of the conceptual blend",
            "The response should include a thoughtful discussion of evaluation methods, limitations, and ethical implications",
            "The submission should demonstrate interdisciplinary knowledge integration",
            "The proposed AI system and methods should be creative yet scientifically plausible",
            "The response should follow the specified format with clear headings for each section",
            "The response should be within the specified word count range (1050-1400 words)"
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
