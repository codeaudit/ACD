import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        scientific_concepts = [
            {
                "concept": "Quantum Entanglement",
                "domain": "Quantum Physics"
            },
            {
                "concept": "Epigenetics",
                "domain": "Molecular Biology"
            }
        ]
        return {
            "1": random.choice(scientific_concepts),
            "2": random.choice(scientific_concepts)
        }

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design an AI system capable of generating and interpreting novel metaphors, then apply it to explain the complex scientific concept of {t['concept']} from the domain of {t['domain']}. Your response should include:

1. Metaphorical Reasoning Framework (250-300 words):
   a) Explain the cognitive linguistic principles underlying metaphorical reasoning.
   b) Describe how your AI system models these principles.
   c) Discuss how your system generates novel metaphors.
   d) Explain how your system interprets and evaluates the aptness of metaphors.

2. AI System Architecture (300-350 words):
   a) Provide a high-level overview of your AI system's architecture.
   b) Explain how your system integrates knowledge from different domains to create metaphors.
   c) Describe the key components and their interactions within your system.
   d) Discuss any novel elements in your design that enable metaphorical reasoning.

3. Metaphor Generation Process (250-300 words):
   a) Outline the steps your AI system takes to generate metaphors for the given scientific concept.
   b) Explain how the system ensures the metaphors are both novel and apt.
   c) Provide an example of how a specific metaphor might be generated using your system.

4. Concept Explanation (250-300 words):
   a) Present three novel metaphors generated by your AI system to explain {t['concept']}.
   b) For each metaphor, provide:
      - A brief explanation of the metaphor
      - How it relates to the scientific concept
      - Its strengths and limitations in explaining the concept

5. Metaphor Interpretation and Evaluation (200-250 words):
   a) Describe how your AI system would interpret and evaluate the metaphors it generated.
   b) Discuss the criteria used for assessing the quality and aptness of the metaphors.
   c) Explain how the system might refine or improve its metaphors based on this evaluation.

6. Cognitive and Educational Implications (200-250 words):
   a) Discuss the potential cognitive benefits of using metaphors to explain complex scientific concepts.
   b) Explore how this AI system could be used in educational settings.
   c) Consider any potential drawbacks or limitations of relying on metaphorical explanations for scientific concepts.

7. Ethical and Philosophical Considerations (150-200 words):
   a) Discuss the ethical implications of using AI-generated metaphors to explain scientific concepts.
   b) Explore the philosophical questions raised by an AI system capable of metaphorical reasoning.
   c) Consider the potential impact on human creativity and understanding.

Ensure your response demonstrates a deep understanding of cognitive linguistics, artificial intelligence, and the chosen scientific domain. Use technical terminology appropriately and provide explanations where necessary. Be creative and innovative in your approach while maintaining scientific plausibility.

Format your response using clear headings for each section, exactly as numbered above. Begin each section with the heading (e.g., '1. Metaphorical Reasoning Framework:') on a new line, followed by your response for that section. Your total response should be between 1600-1950 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            "The response demonstrates a thorough understanding of cognitive linguistics principles and metaphorical reasoning.",
            "The AI system design is innovative, detailed, and scientifically plausible, incorporating principles from cognitive science and AI.",
            "The metaphor generation process is well-explained and demonstrates creativity and aptness in relation to the given scientific concept.",
            "The generated metaphors are novel, relevant, and effectively explain the complex scientific concept.",
            "The metaphor interpretation and evaluation process is logically sound and demonstrates critical thinking.",
            "The discussion of cognitive, educational, ethical, and philosophical implications is insightful and well-reasoned.",
            "The response shows strong interdisciplinary reasoning, combining insights from cognitive science, linguistics, AI, and the specific scientific domain.",
            "The writing is clear, well-structured, and adheres to the specified format and word limits for each section."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
