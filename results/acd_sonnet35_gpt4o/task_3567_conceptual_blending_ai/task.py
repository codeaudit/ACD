import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        domains = [
            "Art",
            "Technology",
            "Biology",
            "Architecture",
            "Music",
            "Cuisine",
            "Transportation",
            "Education"
        ]
        tasks = {}
        for i in range(2):
            domain1, domain2 = random.sample(domains, 2)
            tasks[str(i+1)] = {
                "domain1": domain1,
                "domain2": domain2
            }
        return tasks

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design an AI system that performs conceptual blending between the domains of {t['domain1']} and {t['domain2']} to generate novel ideas. Then, analyze its output for creativity and practicality. Your response should include:

1. System Architecture (300-350 words):
   a) Describe the key components of your AI conceptual blending system.
   b) Explain how your system represents and processes concepts from different domains.
   c) Detail the algorithms or methods used for conceptual blending and idea generation.
   d) Discuss how your system evaluates the novelty and coherence of generated ideas.

2. Knowledge Representation (250-300 words):
   a) Explain how your system represents knowledge from the domains of {t['domain1']} and {t['domain2']}.
   b) Describe any ontologies, semantic networks, or other structures used to organize domain knowledge.
   c) Discuss how your system identifies potential connections or analogies between concepts from different domains.

3. Blending Process (250-300 words):
   a) Detail the step-by-step process your AI system follows to blend concepts from {t['domain1']} and {t['domain2']}.
   b) Explain how your system selects which elements to blend and how it resolves conflicts or inconsistencies.
   c) Describe any mechanisms for ensuring the blended concepts are both novel and meaningful.

4. Output Analysis (200-250 words):
   a) Present three example ideas generated by your system through conceptual blending.
   b) Analyze each idea for its creativity, coherence, and potential practical applications.
   c) Discuss how these ideas demonstrate the system's ability to generate novel concepts across domains.

5. Creativity Evaluation (200-250 words):
   a) Propose metrics or criteria for evaluating the creativity of your system's output.
   b) Explain how you would measure the system's performance compared to human creativity in conceptual blending.
   c) Discuss any limitations in computationally assessing creativity and how you address them.

6. Potential Applications (150-200 words):
   a) Suggest three potential real-world applications for your conceptual blending AI system.
   b) Briefly explain how each application could benefit from the system's ability to generate novel ideas.
   c) Discuss any ethical considerations or potential risks associated with these applications.

7. Future Improvements (150-200 words):
   a) Propose two potential enhancements to your AI system that could improve its conceptual blending capabilities.
   b) Explain how these improvements could lead to more creative or practical outputs.
   c) Discuss any emerging technologies or research areas that could significantly advance AI conceptual blending.

Ensure your response demonstrates a deep understanding of conceptual blending, knowledge representation, and creative AI systems. Use appropriate technical terminology and provide clear explanations for complex concepts. Be innovative in your approach while maintaining scientific plausibility.

Format your response with clear headings for each section, numbered as above. Your total response should be between 1500-1850 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response must describe a well-defined AI system for conceptual blending between {t['domain1']} and {t['domain2']}",
            "The system architecture and blending process should be clearly explained and scientifically plausible",
            "The response should include creative and coherent example ideas generated by the system",
            "The analysis should demonstrate a deep understanding of conceptual blending and creativity in AI"
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0