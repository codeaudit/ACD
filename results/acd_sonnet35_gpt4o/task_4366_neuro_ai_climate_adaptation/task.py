import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        scenarios = [
            {
                "climate_factor": "Extreme heat waves",
                "cognitive_impact": "Impaired decision-making"
            },
            {
                "climate_factor": "Increased air pollution",
                "cognitive_impact": "Reduced attention span"
            },
            {
                "climate_factor": "Altered precipitation patterns",
                "cognitive_impact": "Memory deficits"
            },
            {
                "climate_factor": "Rising sea levels",
                "cognitive_impact": "Increased anxiety and stress"
            }
        ]
        return {str(i+1): task for i, task in enumerate(random.sample(scenarios, 2))}

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design a brain-inspired AI system for predicting and mitigating the neurological impacts of climate change on human cognition, focusing on the climate factor of {t['climate_factor']} and its impact on {t['cognitive_impact']}. Then, analyze its potential applications and ethical implications. Your response should include:

1. Neuro-AI System Architecture (300-350 words):
   a) Describe the key components of your brain-inspired AI system, including how it models relevant brain functions.
   b) Explain how your system integrates climate data with neurological models.
   c) Detail the AI techniques used for prediction and mitigation of cognitive impacts.
   d) Discuss how your system adapts to changing climate conditions and variations in human neurological responses.

2. Climate-Cognition Modeling (250-300 words):
   a) Explain how your system models the relationship between {t['climate_factor']} and {t['cognitive_impact']}.
   b) Describe the data sources and parameters your system uses to assess climate-induced neurological changes.
   c) Discuss how your system accounts for individual variability in cognitive responses to climate factors.

3. Mitigation Strategies (250-300 words):
   a) Detail the process of generating personalized strategies to mitigate {t['cognitive_impact']} caused by {t['climate_factor']}.
   b) Explain how your system tailors interventions based on individual neurological profiles and environmental conditions.
   c) Provide an example of a potential mitigation strategy generated by your system, including its rationale and expected impact.

4. Potential Applications (200-250 words):
   a) Identify three potential applications of your system in different sectors (e.g., public health, urban planning, education).
   b) Discuss how widespread adoption of your system could affect climate change adaptation strategies.
   c) Analyze potential challenges or limitations in implementing your system on a large scale.

5. Ethical Implications (200-250 words):
   a) Identify three potential ethical concerns raised by your neuro-AI system.
   b) Discuss the balance between individual privacy and the need for detailed neurological and environmental data.
   c) Propose guidelines for the responsible development and deployment of your system.

6. Future Developments (150-200 words):
   a) Suggest two potential enhancements to your system that could increase its effectiveness or scope.
   b) Discuss how your system could be adapted to address other climate-induced health impacts.

Ensure your response demonstrates a deep understanding of neuroscience, artificial intelligence, and climate science. Use appropriate technical terminology and provide clear explanations for complex concepts. Be innovative in your approach while maintaining scientific plausibility.

Format your response with clear headings for each section, numbered as above. Your total response should be between 1350-1650 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response must address the climate factor of {t['climate_factor']} and its impact on {t['cognitive_impact']}",
            "The system design should demonstrate integration of neuroscience, AI, and climate science",
            "The response should include a detailed analysis of potential applications and ethical implications",
            "The proposed mitigation strategies should be innovative, personalized, and scientifically plausible",
            "The response should demonstrate a deep understanding of the interdisciplinary nature of the task"
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
