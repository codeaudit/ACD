import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        scientific_phenomena = [
            {
                "phenomenon": "quantum entanglement",
                "description": "A quantum mechanical phenomenon where the quantum states of two or more objects are described with reference to each other, even when spatially separated"
            },
            {
                "phenomenon": "bioluminescence",
                "description": "The production and emission of light by living organisms"
            },
            {
                "phenomenon": "gravitational waves",
                "description": "Ripples in the curvature of spacetime that propagate as waves, generated by accelerated masses"
            },
            {
                "phenomenon": "neural plasticity",
                "description": "The ability of the brain to change and reorganize itself by forming new neural connections"
            },
            {
                "phenomenon": "dark matter",
                "description": "A hypothetical form of matter that is thought to account for approximately 85% of the matter in the universe"
            },
            {
                "phenomenon": "superposition",
                "description": "A principle of quantum theory that describes a challenging-to-understand situation in which an object simultaneously exists in more than one state"
            }
        ]
        
        sensory_combinations = [
            "visual-auditory",
            "tactile-olfactory",
            "gustatory-proprioceptive",
            "auditory-vestibular",
            "visual-tactile",
            "olfactory-gustatory"
        ]
        
        return {
            "1": {"phenomenon": random.choice(scientific_phenomena), "sensory_combo": random.choice(sensory_combinations)},
            "2": {"phenomenon": random.choice(scientific_phenomena), "sensory_combo": random.choice(sensory_combinations)}
        }

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Create a new form of multisensory art based on the scientific phenomenon of {t['phenomenon']['phenomenon']} that combines {t['sensory_combo']} experiences. Your response should include:

1. Artistic Concept (200-250 words):
   a) Describe the overall concept of your multisensory art piece.
   b) Explain how it incorporates the scientific phenomenon: {t['phenomenon']['description']}
   c) Detail how the art piece combines the {t['sensory_combo']} sensory experiences.

2. Scientific Principles (150-200 words):
   a) Explain the key scientific principles from the phenomenon that are represented in your art.
   b) Discuss how these principles are translated into sensory experiences.

3. Sensory Experience (200-250 words):
   a) Describe in detail how a person would experience your art piece.
   b) Explain how the different sensory elements interact and complement each other.
   c) Discuss any potential synesthetic effects your art might induce. (Note: Synesthesia is a perceptual phenomenon in which stimulation of one sensory or cognitive pathway leads to involuntary experiences in a second sensory or cognitive pathway.)

4. Technical Implementation (150-200 words):
   a) Propose a method for creating and displaying your multisensory art piece.
   b) Discuss any technical challenges and how they might be overcome.

5. Artistic and Scientific Implications (100-150 words):
   a) Discuss the potential impact of your art form on traditional artistic expression.
   b) Explain how this approach might contribute to scientific understanding or communication.

6. Ethical Considerations (100-150 words):
   a) Identify potential ethical issues or health concerns related to your multisensory art.
   b) Suggest guidelines for responsible creation and experience of this type of art.

Ensure your response demonstrates a deep understanding of the scientific phenomenon, sensory perception, and artistic expression. Be innovative in your approach while maintaining scientific accuracy and artistic integrity.

Format your response with clear headings for each section and adhere to the specified word limits."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response should clearly incorporate principles from the scientific phenomenon of {t['phenomenon']['phenomenon']}.",
            f"The art piece should combine {t['sensory_combo']} experiences in a novel and meaningful way.",
            "The proposed multisensory art should be innovative and creative while remaining scientifically grounded.",
            "The response should demonstrate a deep understanding of the scientific phenomenon, sensory perception, and artistic expression.",
            "All six requested sections should be present and adequately addressed.",
            "The technical implementation and ethical considerations should be thoughtfully explored.",
            "The response should follow the specified format with clear headings and adhere to the word limits."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
