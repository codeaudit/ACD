import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        language_structures = [
            {
                "name": "Temporal-Centric",
                "feature": "Highly detailed tense system with multiple future and past tenses"
            },
            {
                "name": "Spatial-Dominant",
                "feature": "Extensive system of spatial prepositions and locative cases"
            },
            {
                "name": "Color-Focused",
                "feature": "Rich color vocabulary with fine-grained distinctions"
            },
            {
                "name": "Evidentiality-Based",
                "feature": "Grammatical markers indicating source and reliability of information"
            }
        ]
        problem_domains = [
            "Navigation in an unfamiliar city",
            "Describing a complex emotional experience",
            "Solving a logical puzzle",
            "Explaining a scientific concept"
        ]
        return {
            "1": {
                "language": random.choice(language_structures),
                "problem": random.choice(problem_domains)
            },
            "2": {
                "language": random.choice(language_structures),
                "problem": random.choice(problem_domains)
            }
        }

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design an AI system that simulates the effects of linguistic relativity by generating problem-solving approaches in an artificially constructed language with the following structural property: {t['language']['feature']}. Then, apply this system to the problem domain of {t['problem']}.

Your response should include:

1. Language Design (200-250 words):
   a) Create a basic vocabulary and grammar for your artificial language that emphasizes the given structural property.
   b) Explain how this language feature might influence cognitive processes related to the problem domain.
   c) Provide 3-5 example sentences in your language with English translations.

2. AI System Architecture (250-300 words):
   a) Describe the components of your AI system that generate problem-solving approaches in the artificial language.
   b) Explain how your system models the influence of language structure on cognitive strategies.
   c) Detail any novel techniques or algorithms used in your system.

3. Problem-Solving Simulation (200-250 words):
   a) Generate a specific problem scenario within the given domain.
   b) Demonstrate how your AI system would approach solving this problem using the artificial language.
   c) Provide examples of the AI's 'thought process' in the artificial language with English translations.

4. Comparative Analysis (200-250 words):
   a) Compare the problem-solving approach generated by your system to a hypothetical approach in a language without the specified structural property.
   b) Analyze potential differences in strategy, focus, or efficiency.
   c) Discuss how these differences relate to the theory of linguistic relativity.

5. Implications and Limitations (150-200 words):
   a) Discuss potential implications of your findings for understanding human cognition and language.
   b) Address limitations of your approach and potential biases in the simulation.
   c) Suggest future experiments or expansions to further explore linguistic relativity using AI.

Ensure your response demonstrates a deep understanding of linguistic theory, cognitive science, and AI systems. Be creative in your language design and analytical approach while maintaining scientific plausibility. Use appropriate terminology and provide clear explanations where necessary.

Format your response using the numbered structure provided above, with clear headings for each section. Your total response should be between 1000-1250 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response must include a well-designed artificial language emphasizing the structural property: {t['language']['feature']}.",
            f"The AI system architecture should clearly model the influence of language structure on cognitive strategies for the problem domain: {t['problem']}.",
            "The problem-solving simulation should demonstrate a clear link between the language structure and the approach taken.",
            "The comparative analysis should provide insightful differences between the artificial language approach and a hypothetical standard approach.",
            "The response should discuss implications and limitations of the simulation in relation to linguistic relativity theory.",
            "The overall response should demonstrate creativity, interdisciplinary knowledge integration, and analytical reasoning.",
            "The response should follow the provided structure and word limits."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
