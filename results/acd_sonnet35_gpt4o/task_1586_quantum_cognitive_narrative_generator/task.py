import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        quantum_principles = [
            "Superposition",
            "Entanglement",
            "Quantum tunneling",
            "Quantum interference"
        ]
        emotional_states = [
            "Joy",
            "Sorrow",
            "Anger",
            "Fear",
            "Surprise"
        ]
        narrative_elements = [
            "Character development",
            "Plot structure",
            "Setting description",
            "Dialogue generation",
            "Thematic exploration"
        ]
        return {
            "1": {
                "quantum_principle": random.choice(quantum_principles),
                "emotional_state": random.choice(emotional_states),
                "narrative_element": random.choice(narrative_elements)
            },
            "2": {
                "quantum_principle": random.choice(quantum_principles),
                "emotional_state": random.choice(emotional_states),
                "narrative_element": random.choice(narrative_elements)
            }
        }

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design a quantum computing algorithm that simulates cognitive processes to generate creative narratives based on the emotional state of {t['emotional_state']}, the quantum principle of {t['quantum_principle']}, and focusing on the narrative element of {t['narrative_element']}.

Your response should include the following sections:

1. Quantum Algorithm Design (250-300 words):
   a) Describe the key components of your quantum algorithm for narrative generation.
   b) Explain how you incorporate the specified quantum principle into your algorithm.
   c) Discuss how your algorithm simulates cognitive processes related to creativity and emotional processing.
   d) Include a high-level pseudocode or quantum circuit diagram to illustrate your algorithm.

2. Cognitive-Quantum Mapping (200-250 words):
   a) Explain how you map cognitive processes of narrative creation to quantum states and operations.
   b) Describe how the specified emotional state is represented and processed in your quantum system.
   c) Discuss how quantum phenomena might enhance or alter traditional cognitive models of creativity.

3. Narrative Generation Process (200-250 words):
   a) Provide a step-by-step explanation of how your algorithm generates a narrative.
   b) Explain how the specified narrative element is particularly enhanced by your quantum-cognitive approach.
   c) Discuss how quantum properties might lead to unique or unexpected narrative outcomes.

4. Sample Output (150-200 words):
   a) Provide a brief example of a narrative fragment generated by your algorithm.
   b) Explain how this output demonstrates the influence of the specified quantum principle and emotional state.

5. Evaluation and Implications (200-250 words):
   a) Propose methods to evaluate the creativity and coherence of the generated narratives.
   b) Discuss potential implications of your quantum-cognitive approach for understanding human creativity and consciousness.
   c) Explore how this technology might impact fields such as artificial intelligence, psychology, and the creative arts.

Ensure your response demonstrates a deep understanding of quantum computing, cognitive science, and creative writing. Use technical terminology appropriately and provide explanations where necessary. Be innovative in your approach while maintaining scientific plausibility."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response must address the quantum principle of {t['quantum_principle']}.",
            f"The algorithm should incorporate the emotional state of {t['emotional_state']}.",
            f"The narrative generation should focus on the element of {t['narrative_element']}.",
            "The response must include all five required sections: Quantum Algorithm Design, Cognitive-Quantum Mapping, Narrative Generation Process, Sample Output, and Evaluation and Implications.",
            "The quantum algorithm design must be innovative and demonstrate a clear integration of quantum computing principles with cognitive science and narrative generation.",
            "The cognitive-quantum mapping should show a deep understanding of both quantum mechanics and cognitive processes related to creativity.",
            "The narrative generation process must provide a clear and plausible explanation of how the algorithm works.",
            "The sample output should reflect the influence of the specified quantum principle and emotional state.",
            "The evaluation and implications section should provide thoughtful insights into the potential impact of this technology."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
