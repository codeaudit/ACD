import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        scientific_domains = [
            "quantum mechanics",
            "evolutionary biology",
            "neuroscience",
            "climate science",
            "astrophysics"
        ]
        metaphor_types = [
            "structural",
            "ontological",
            "orientational"
        ]
        return {
            "1": {"domain": random.choice(scientific_domains), "metaphor_type": random.choice(metaphor_types)},
            "2": {"domain": random.choice(scientific_domains), "metaphor_type": random.choice(metaphor_types)}
        }

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design an AI system that generates and interprets metaphors using principles of conceptual blending theory, then apply it to analyze complex scientific concepts in the domain of {t['domain']}. Your system should focus on generating {t['metaphor_type']} metaphors. Your response should include:

1. Conceptual Blending Framework (250-300 words):
   a) Explain the key principles of conceptual blending theory.
   b) Describe how your AI system implements these principles for metaphor generation and interpretation.
   c) Discuss any novel approaches or extensions to the theory in your implementation.

2. AI System Architecture (300-350 words):
   a) Outline the main components of your AI system for metaphor processing.
   b) Explain how your system integrates conceptual blending with natural language processing techniques.
   c) Describe the process of metaphor generation and interpretation in your system.
   d) Include a high-level diagram or pseudocode representing a crucial part of your system (describe it textually).

3. Scientific Domain Application (250-300 words):
   a) Analyze how your system would approach metaphor generation for complex concepts in {t['domain']}.
   b) Provide an example of a {t['metaphor_type']} metaphor your system might generate for a specific concept in this domain.
   c) Explain how your system would interpret and analyze existing metaphors in scientific literature related to {t['domain']}.

4. Cognitive and Linguistic Analysis (200-250 words):
   a) Discuss how your system's approach relates to theories of human cognition and language processing.
   b) Analyze potential cognitive advantages or limitations of using your system's metaphors for scientific understanding.
   c) Compare your system's metaphor processing capabilities to human performance.

5. Evaluation and Validation (200-250 words):
   a) Propose methods to evaluate the quality and effectiveness of the metaphors generated by your system.
   b) Describe potential experiments to validate your system's metaphor interpretation capabilities.
   c) Discuss how you would measure the system's impact on scientific communication and understanding.

6. Ethical Considerations and Future Directions (150-200 words):
   a) Address potential ethical concerns related to AI-generated metaphors in scientific communication.
   b) Discuss possible extensions or modifications to your system for other applications.
   c) Speculate on how this technology might influence scientific discourse and education in the future.

Ensure your response demonstrates a deep understanding of conceptual blending theory, cognitive linguistics, and artificial intelligence. Use appropriate technical terminology and provide clear explanations for complex concepts. Be innovative in your approach while maintaining scientific plausibility.

Format your response with clear headings for each section, adhering to the word limits provided. Your total response should be between 1350-1650 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response should clearly describe an AI system that generates and interprets metaphors using conceptual blending theory principles.",
            f"The system should be applied to analyze complex scientific concepts in the domain of {t['domain']}.",
            f"The response should demonstrate a deep understanding of conceptual blending theory, cognitive linguistics, and artificial intelligence.",
            f"The proposed system should focus on generating {t['metaphor_type']} metaphors.",
            "The response should include all six requested sections with appropriate content and adhere to the word limits.",
            "The proposed AI system should be innovative while maintaining scientific plausibility."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
