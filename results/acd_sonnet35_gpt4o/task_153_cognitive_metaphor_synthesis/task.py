import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        cognitive_architectures = [
            {
                "name": "ACT-R",
                "description": "Adaptive Control of Thought-Rational, emphasizing symbolic processing and production rules"
            },
            {
                "name": "Connectionist",
                "description": "Neural network-based architecture focusing on distributed representations and parallel processing"
            },
            {
                "name": "Global Workspace Theory",
                "description": "Architecture based on a 'theater of consciousness' with a global workspace for information integration"
            }
        ]
        return {
            "1": random.choice(cognitive_architectures),
            "2": random.choice(cognitive_architectures)
        }

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design a metaphor generation system based on the {t['name']} cognitive architecture ({t['description']}), and use it to create novel metaphors. Your task has the following parts:

1. Metaphor Generation System Design (4-5 sentences):
   - Describe how your system would represent and process metaphors based on the given cognitive architecture.
   - Explain how your system incorporates key features of the {t['name']} architecture.
   - Discuss how your system handles the mapping between source and target domains in metaphors.

2. Cognitive Process Simulation (3-4 sentences):
   - Explain how your system simulates the cognitive processes involved in metaphor comprehension and generation.
   - Describe any specific mechanisms or algorithms your system uses to create novel metaphors.

3. Novel Metaphor Examples (2-3 sentences per metaphor):
   - Generate two novel metaphors using your system.
   - For each metaphor, explain its meaning and how it was generated by your system.

4. Comparison to Human Cognition (3-4 sentences):
   - Compare your system's metaphor generation process to what we know about human metaphor processing.
   - Identify similarities and differences between your system and human cognitive processes.

5. Limitations and Potential Improvements (2-3 sentences):
   - Discuss two limitations of your metaphor generation system.
   - Propose ways to extend or modify your system to overcome these limitations.

6. Cross-Architectural Implications (3-4 sentences):
   - Speculate on how metaphor generation might differ if implemented in a different cognitive architecture.
   - Discuss potential implications for our understanding of human cognition and AI systems.

7. Evaluation Metrics (2-3 sentences):
   - Propose metrics to evaluate the quality and creativity of the metaphors generated by your system.
   - Explain how these metrics relate to the cognitive processes simulated by your system.

Ensure your response is creative, grounded in cognitive science principles, and demonstrates a deep understanding of both metaphor theory and the given cognitive architecture. Organize your response using clear headings for each section."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The metaphor generation system design incorporates key features of the {t['name']} cognitive architecture",
            "The cognitive process simulation explains how the system comprehends and generates metaphors",
            "Two novel metaphors are provided with explanations of their meaning and generation process",
            "The system is compared to human cognition, identifying similarities and differences",
            "Two limitations of the system are discussed with proposed improvements",
            "Cross-architectural implications are discussed, including potential differences in metaphor generation",
            "Evaluation metrics are proposed and related to the simulated cognitive processes",
            "The response demonstrates creativity and a deep understanding of metaphor theory and cognitive architectures",
            "The response is well-organized with clear headings for each section"
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
