import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        genres = [
            "classical",
            "jazz",
            "electronic",
            "folk",
            "hip-hop",
            "ambient"
        ]
        quantum_principles = [
            "superposition",
            "entanglement",
            "interference",
            "quantum annealing",
            "quantum walks",
            "adiabatic quantum computation"
        ]
        
        tasks = [
            {
                "genre": random.choice(genres),
                "quantum_principle": random.choice(quantum_principles)
            } for _ in range(2)
        ]
        
        return {str(i+1): task for i, task in enumerate(tasks)}

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design a quantum-inspired AI system capable of composing original music in the {t['genre']} genre, leveraging the quantum principle of {t['quantum_principle']}. Then, analyze its potential impact on the creative arts and music industry. Your response should include:

1. Quantum-Inspired AI Architecture (300-350 words):
   a) Describe the key components of your AI system for music composition.
   b) Explain how your system integrates the specified quantum principle into its architecture.
   c) Detail how the system processes musical elements (e.g., melody, harmony, rhythm) using quantum-inspired algorithms.
   d) Discuss any novel approaches you've incorporated to enhance creative capabilities.
   e) Provide a specific example of a quantum-inspired algorithm used in your system, including its mathematical formulation.
   f) Explain in detail how the quantum principle of {t['quantum_principle']} is applied in the music composition process, providing a step-by-step breakdown.

2. Music Composition Process (250-300 words):
   a) Explain the step-by-step process your AI system would use to compose a piece in the given genre.
   b) Provide an example of how the specified quantum principle influences the composition process.
   c) Discuss how your system ensures originality and adherence to genre conventions.
   d) Describe any techniques used to generate emotional or stylistic variations in compositions.
   e) Include a brief example (2-4 measures) of a musical composition snippet generated by your system, explaining how it reflects the genre and quantum principle.
   f) Discuss potential failure modes of your quantum-inspired AI system and how they might manifest in the composed music.

3. Quantum Advantage Analysis (200-250 words):
   a) Analyze the potential advantages of your quantum-inspired approach over classical AI composition methods.
   b) Discuss any limitations or challenges specific to your quantum-inspired system.
   c) Propose a method to quantify the 'quantum advantage' in terms of creativity or compositional quality.
   d) Suggest an experiment to compare your quantum-inspired system with a classical AI composer.
   e) Propose a novel evaluation metric for assessing the creativity of AI-generated music, explaining how it incorporates both quantum and musical principles.

4. Creative Arts Impact (200-250 words):
   a) Discuss how your Quantum Creative AI Composer could influence the creative process for human musicians.
   b) Analyze potential changes in music production and consumption patterns.
   c) Explore the implications for copyright and intellectual property in AI-generated music.
   d) Consider how this technology might affect music education and skill development for aspiring musicians.

5. Music Industry Transformation (200-250 words):
   a) Predict how widespread adoption of quantum-inspired AI composers might reshape the music industry.
   b) Discuss potential new business models or career opportunities that could emerge.
   c) Address concerns about AI replacing human musicians and propose solutions.
   d) Analyze how this technology might impact music diversity and representation in the industry.

6. Ethical and Societal Implications (200-250 words):
   a) Discuss ethical considerations related to AI systems that can generate creative works.
   b) Consider the societal impact of highly advanced AI composers on cultural expression and diversity.
   c) Propose guidelines for the responsible development and use of creative AI systems.
   d) Explore a scenario where quantum-inspired AI composers are used in mental health therapy, discussing both potential benefits and ethical concerns.
   e) Address the issue of AI-generated music potentially amplifying biases present in training data.

7. Future Research Directions (100-150 words):
   a) Suggest two potential areas for further research to advance quantum-inspired creative AI systems.
   b) Explain how these research directions could address current limitations or open up new possibilities in AI-generated art.

Ensure your response demonstrates a deep understanding of quantum computing principles, artificial intelligence, music theory, and the creative process. Use appropriate technical terminology and provide clear explanations where necessary. Be creative and speculative in your approach while maintaining scientific plausibility.

Format your response using clear headings for each section, numbered as above. Your total response should be between 1500-1850 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response must design an AI system for composing music in the {t['genre']} genre using the quantum principle of {t['quantum_principle']}",
            "The proposed AI system architecture should be scientifically plausible and clearly explained, including a specific quantum-inspired algorithm with its mathematical formulation",
            f"A detailed explanation of how the quantum principle of {t['quantum_principle']} is applied in the music composition process must be provided",
            "The response should demonstrate interdisciplinary knowledge integration across quantum computing, AI, and music theory",
            "The music composition process should be well-defined and logically incorporate the specified quantum principle",
            "A brief example (2-4 measures) of a musical composition snippet should be included and explained",
            "Potential failure modes of the quantum-inspired AI system should be discussed",
            "The analysis of quantum advantage should be thoughtful and scientifically grounded, including a proposed experiment",
            "A novel evaluation metric for assessing the creativity of AI-generated music should be proposed",
            "The impact on creative arts and music industry should be thoroughly addressed, including effects on music education and diversity",
            "Ethical implications must be thoughtfully considered, including a scenario involving mental health therapy and potential biases",
            "Future research directions should be relevant and well-justified",
            "The response should follow the specified format with clear headings for each section",
            "The response should be within the specified word count range (1500-1850 words)"
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
