import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        brain_regions = [
            "amygdala",
            "hippocampus",
            "prefrontal cortex",
            "cerebellum",
            "auditory cortex"
        ]
        musical_elements = [
            "rhythm",
            "melody",
            "harmony",
            "timbre",
            "dynamics"
        ]
        tasks = {
            "1": {"brain_region": random.choice(brain_regions), "musical_element": random.choice(musical_elements)},
            "2": {"brain_region": random.choice(brain_regions), "musical_element": random.choice(musical_elements)}
        }
        return tasks

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design a neural network-inspired system that composes music by mimicking human creativity and emotional expression, focusing on the {t['brain_region']} and its role in generating {t['musical_element']}. Then, analyze its output and implications. Your response should include:

1. System Architecture (300-350 words):
   a) Describe the key components of your neuro-AI music composition system.
   b) Explain how your system models the functions of the {t['brain_region']}.
   c) Detail how your system generates and manipulates {t['musical_element']}.
   d) Include a diagram or pseudocode representing your system's structure (describe it textually).

2. Neuroscience-AI Integration (250-300 words):
   a) Explain how your system incorporates current neuroscientific understanding of the {t['brain_region']}.
   b) Describe any novel AI techniques used to model neural processes related to {t['musical_element']}.
   c) Discuss how your approach bridges the gap between biological and artificial creativity.

3. Music Generation Process (250-300 words):
   a) Outline the step-by-step process of how your system composes music.
   b) Explain how emotional expression is encoded and translated into musical features.
   c) Describe how your system ensures coherence and aesthetic quality in its compositions.

4. Output Analysis (200-250 words):
   a) Analyze a hypothetical piece of music generated by your system.
   b) Explain how the output reflects the influence of the {t['brain_region']} and manipulation of {t['musical_element']}.
   c) Compare the output to human-composed music, highlighting similarities and differences.

5. Ethical and Philosophical Implications (200-250 words):
   a) Discuss the ethical considerations of using AI to mimic human creativity.
   b) Explore the philosophical questions raised by your system regarding consciousness and creativity.
   c) Propose guidelines for the responsible development and use of AI in artistic creation.

6. Future Directions and Applications (150-200 words):
   a) Suggest potential improvements or extensions to your system.
   b) Propose practical applications of your neuro-AI music composition system.
   c) Speculate on how this technology might impact the music industry and human composers.

Ensure your response demonstrates a deep understanding of neuroscience, artificial intelligence, and music theory. Use appropriate technical terminology and provide clear explanations for complex concepts. Be innovative in your approach while maintaining scientific plausibility.

Format your response with clear headings for each section. Your total response should be between 1350-1650 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response must demonstrate a clear understanding of the {t['brain_region']} and its role in music cognition and creation.",
            f"The system design should effectively incorporate both neuroscientific principles and AI techniques in generating {t['musical_element']}.",
            "The music generation process should be well-explained, innovative, and scientifically plausible.",
            "The response should include a thoughtful analysis of the system's output and its implications for human creativity and the music industry.",
            "The ethical and philosophical discussion should be nuanced and demonstrate critical thinking about AI's role in artistic creation."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
