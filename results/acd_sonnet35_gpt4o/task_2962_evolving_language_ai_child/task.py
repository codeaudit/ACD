import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        cognitive_stages = [
            'Sensorimotor',
            'Preoperational',
            'Concrete operational',
            'Formal operational'
        ]
        language_aspects = [
            'Phonology',
            'Morphology',
            'Syntax',
            'Semantics',
            'Pragmatics'
        ]
        
        tasks = {}
        for i in range(1, 3):
            stage = random.choice(cognitive_stages)
            aspect = random.choice(language_aspects)
            tasks[str(i)] = {
                'cognitive_stage': stage,
                'language_aspect': aspect
            }
        return tasks

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"Design an AI system that simulates the evolution of language in parallel with cognitive development stages in a child, then use it to generate a novel language and analyze its features. Focus on the {t['cognitive_stage']} stage of cognitive development and the {t['language_aspect']} aspect of language. Your response should include:\n\n" \
               f"1. AI System Architecture (300-350 words):\n" \
               f"   a) Describe the key components of your AI system for simulating language evolution and cognitive development.\n" \
               f"   b) Explain how your system models the {t['cognitive_stage']} stage and its impact on language evolution.\n" \
               f"   c) Detail how your system simulates the development of {t['language_aspect']}.\n" \
               f"   d) Include a simple diagram of your system's architecture (use ASCII characters).\n\n" \
               f"2. Language Evolution Process (250-300 words):\n" \
               f"   a) Explain how your system simulates the evolution of language features.\n" \
               f"   b) Describe how the {t['cognitive_stage']} stage influences this evolution.\n" \
               f"   c) Discuss how {t['language_aspect']} develops in your simulated language.\n\n" \
               f"3. Novel Language Generation (200-250 words):\n" \
               f"   a) Present a sample of the novel language generated by your system.\n" \
               f"   b) Explain key features of this language, focusing on {t['language_aspect']}.\n" \
               f"   c) Discuss how these features reflect the {t['cognitive_stage']} stage of development.\n" \
               f"   d) Provide a small sample (2-3 words or phrases) of your generated language in IPA notation.\n\n" \
               f"4. Comparative Analysis (200-250 words):\n" \
               f"   a) Compare your generated language to existing human languages.\n" \
               f"   b) Analyze similarities and differences in {t['language_aspect']}.\n" \
               f"   c) Discuss what your results suggest about language universals and cognitive development.\n\n" \
               f"5. Cognitive Science Implications (150-200 words):\n" \
               f"   a) Discuss how your model contributes to our understanding of language acquisition and cognitive development.\n" \
               f"   b) Propose an experiment to test a key prediction of your model about human language learning.\n\n" \
               f"6. Ethical Considerations and Limitations (150-200 words):\n" \
               f"   a) Discuss potential ethical implications of simulating language evolution and cognitive development.\n" \
               f"   b) Address limitations of your approach and potential biases in the system.\n\n" \
               f"7. Future Research Directions (100-150 words):\n" \
               f"   a) Suggest two potential extensions or applications of your AI system.\n" \
               f"   b) Propose areas for future research in computational linguistics and cognitive science based on your findings.\n\n" \
               f"Ensure your response demonstrates a deep understanding of linguistics, cognitive development theories, and artificial intelligence. Be innovative in your approach while maintaining scientific plausibility. Use appropriate technical terminology and provide clear explanations for complex concepts.\n\n" \
               f"Format your response with clear headings for each section. Your total response should be between 1350-1700 words. Include a word count at the end of your response."

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            f"The response effectively addresses the {t['cognitive_stage']} stage of cognitive development and its impact on language evolution.",
            f"The system design and language generation process demonstrate a deep understanding of {t['language_aspect']} in linguistics.",
            "The AI system architecture is innovative, coherent, and scientifically plausible.",
            "The generated novel language sample is creative and reflects the specified cognitive stage and language aspect.",
            "The response includes a small sample of the generated language in IPA notation.",
            "The comparative analysis provides insightful connections between the generated language and existing human languages.",
            "The response demonstrates a strong interdisciplinary understanding, integrating concepts from linguistics, cognitive science, and AI.",
            "The ethical considerations and limitations are thoughtfully addressed.",
            "The proposed future research directions are innovative and relevant to the field."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
