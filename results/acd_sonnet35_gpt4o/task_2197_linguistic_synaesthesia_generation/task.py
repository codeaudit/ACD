import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        sensory_modalities = ['visual', 'auditory', 'olfactory', 'gustatory', 'tactile']
        abstract_concepts = ['time', 'emotion', 'thought', 'memory', 'identity', 'creativity', 'justice', 'freedom', 'beauty', 'truth']
        
        tasks = {
            "1": {
                "source_modality": random.choice(sensory_modalities),
                "target_concept": random.choice(abstract_concepts)
            },
            "2": {
                "source_modality": random.choice(sensory_modalities),
                "target_concept": random.choice(abstract_concepts)
            }
        }
        
        return tasks

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Linguistic synaesthesia refers to the phenomenon where sensory experiences from one modality are described using terms from another modality, or where sensory experiences are used to describe abstract concepts. Your task is to design a system for generating and analyzing linguistic synaesthesia, focusing on mapping experiences from the {t['source_modality']} modality to expressions of {t['target_concept']}.

Your response should include:

1. Synaesthetic Mapping Framework (200-250 words):
   a) Explain how your system represents and processes sensory experiences in the {t['source_modality']} modality.
   b) Describe the mechanism for mapping these experiences to linguistic expressions of {t['target_concept']}.
   c) Provide an example of a synaesthetic expression generated by your system, with a detailed explanation of the mapping process.

2. Cognitive Model (150-200 words):
   a) Describe the cognitive model underlying your synaesthetic mapping system.
   b) Explain how this model incorporates current theories in cognitive linguistics and neuroscience.
   c) Discuss any novel approaches you've introduced to model linguistic synaesthesia.

3. Generation and Analysis (200-250 words):
   a) Explain how your system generates novel synaesthetic expressions.
   b) Describe the process for analyzing and interpreting these expressions.
   c) Provide an example of how your system would analyze a given synaesthetic expression, detailing the steps and reasoning involved.

4. Evaluation Metrics (100-150 words):
   a) Propose metrics to evaluate the creativity and cognitive plausibility of the generated synaesthetic expressions.
   b) Explain how these metrics account for both linguistic and cognitive aspects of synaesthesia.

5. Potential Applications (100-150 words):
   a) Discuss potential applications of your system in fields such as cognitive science, linguistics, or artificial intelligence.
   b) Explain how studying linguistic synaesthesia could contribute to our understanding of human cognition and language processing.

6. Limitations and Future Work (100-150 words):
   a) Identify potential limitations or challenges of your system.
   b) Suggest two directions for future research that could enhance our understanding of linguistic synaesthesia or improve the capabilities of your system.

Ensure your response demonstrates a deep understanding of cognitive linguistics, sensory processing, and creative language generation. Use appropriate terminology and provide clear explanations for complex ideas. Be innovative in your approach while maintaining scientific plausibility.

Your total response should be between 850-1150 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            "The response demonstrates a deep understanding of linguistic synaesthesia and cognitive processes.",
            "The proposed system is innovative and scientifically plausible.",
            "The example synaesthetic expressions and analyses are creative and well-explained.",
            "The cognitive model and evaluation metrics are well-justified and grounded in current theories.",
            "The discussion of applications, limitations, and future work is insightful and relevant.",
            "The response adheres to the specified word count range (850-1150 words)."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
