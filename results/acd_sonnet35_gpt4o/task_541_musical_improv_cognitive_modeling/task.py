class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        return {
            "1": {
                "musical_style": "Jazz",
                "cognitive_aspect": "Working memory",
                "mathematical_concept": "Markov chains"
            },
            "2": {
                "musical_style": "Indian classical music",
                "cognitive_aspect": "Auditory scene analysis",
                "mathematical_concept": "Fractal geometry"
            }
        }

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design a cognitive model for musical improvisation in the style of {t['musical_style']}, focusing on the cognitive aspect of {t['cognitive_aspect']} and incorporating the mathematical concept of {t['mathematical_concept']}. Your response should include:

1. Model Overview (250-300 words):
   a) Describe the key components of your cognitive model for musical improvisation.
   b) Explain how it integrates principles from music theory, neuroscience, and information theory.
   c) Discuss how the model incorporates the specified cognitive aspect and mathematical concept.
   d) Provide a diagram of your model architecture using ASCII art or a clear textual description. The diagram should include at least 5 components and their connections.

2. Improvisation Process (200-250 words):
   a) Detail the step-by-step process your model uses to generate musical improvisations.
   b) Explain how the model balances between learned patterns and novel creations.
   c) Describe how the specified cognitive aspect influences the improvisation process.

3. Mathematical Implementation (200-250 words):
   a) Explain how you implement the specified mathematical concept in your model.
   b) Provide a simple mathematical formulation or pseudocode for a key part of your model.
   c) Discuss how this mathematical approach enhances the model's ability to capture the essence of {t['musical_style']} improvisation.

4. Cognitive Plausibility (150-200 words):
   a) Analyze how well your model aligns with current understanding of human cognitive processes in musical improvisation.
   b) Discuss any simplifications or abstractions in your model and their potential impact.
   c) Propose an experiment to test the cognitive plausibility of your model.

5. Musical Output Analysis (150-200 words):
   a) Describe the expected characteristics of the musical improvisations generated by your model.
   b) Explain how these characteristics reflect both the cognitive processes and the style of {t['musical_style']}.
   c) Provide a specific example of a short musical phrase (4-8 measures) that your model might generate, using standard musical notation or a clear textual description.

6. Interdisciplinary Implications (100-150 words):
   a) Explore how insights from your model could inform other areas of cognitive science or artificial intelligence.
   b) Suggest potential applications of your model outside of music generation.

7. Glossary (100-150 words):
   Provide a brief glossary of 5-7 key technical terms used in your response, demonstrating your understanding of concepts from music theory, cognitive science, and mathematics.

Ensure your response demonstrates a deep understanding of music cognition, the specified musical style, and relevant mathematical concepts. Be innovative in your approach while maintaining scientific plausibility.

Format your response with clear headings for each section. Your total response should be between 1150-1500 words, not including the diagram."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            "The response demonstrates a deep understanding of music cognition, the specified musical style, and relevant mathematical concepts.",
            "The cognitive model design is creative, plausible, and effectively incorporates the specified cognitive aspect and mathematical concept.",
            "The improvisation process and mathematical implementation are well-explained and logically consistent.",
            "The analysis of cognitive plausibility and musical output shows insightful reasoning.",
            "The response addresses the interdisciplinary implications of the model.",
            "The response includes a clear model architecture diagram with at least 5 components and their connections.",
            "The response provides a specific example of a generated musical phrase that aligns with the described model and musical style.",
            "The glossary accurately defines 5-7 key technical terms used in the response.",
            "The response adheres to the specified format and word limits."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
