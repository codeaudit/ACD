import random

class TaskFamily:
    @staticmethod
    def get_tasks() -> dict[str, dict]:
        animals = [
            "octopus",
            "honeybee",
            "elephant",
            "dolphin",
            "crow",
            "chimpanzee",
            "spider",
            "ant",
            "bat",
            "squid"
        ]
        cognitive_capabilities = [
            "problem-solving",
            "social cognition",
            "spatial navigation",
            "tool use",
            "memory formation",
            "pattern recognition",
            "decision making",
            "learning and adaptation",
            "sensory integration",
            "communication"
        ]
        return {
            "1": {
                "animal": random.choice(animals),
                "cognitive_capability": random.choice(cognitive_capabilities)
            },
            "2": {
                "animal": random.choice(animals),
                "cognitive_capability": random.choice(cognitive_capabilities)
            }
        }

    @staticmethod
    def get_instructions(t: dict) -> str:
        return f"""Design a biomimetic robot with an artificial nervous system inspired by a {t['animal']}, then propose experiments to test its {t['cognitive_capability']} capabilities. Your response should include the following sections:

1. Biomimetic Robot Design (200-250 words):
   a) Describe the key physical features of your robot inspired by the {t['animal']}.
   b) Explain how you've incorporated the {t['animal']}'s nervous system into your robot's design.
   c) Detail any novel materials or mechanisms used in your robot.
   d) Include a brief description of a diagram or schematic representation of your robot's overall structure and nervous system.

   Example structure (adapt for your specific animal):
   The robot's body mimics the {t['animal']}'s shape, with [key feature 1] and [key feature 2]. Its nervous system includes [neural component 1] and [neural component 2], inspired by the {t['animal']}'s brain structure. Novel materials include [material] for [purpose].

2. Artificial Nervous System (200-250 words):
   a) Explain the architecture of your robot's artificial nervous system.
   b) Describe how it mimics key features of the {t['animal']}'s neural circuits.
   c) Discuss any simplifications or abstractions you've made in your design.
   d) Explain how your artificial nervous system enables {t['cognitive_capability']}.

   Example structure:
   The artificial nervous system consists of [component 1], [component 2], and [component 3], mimicking the {t['animal']}'s [brain region 1] and [brain region 2]. We've simplified [aspect] while maintaining [key feature] to enable {t['cognitive_capability']}.

3. Cognitive Modeling (150-200 words):
   a) Describe how you've modeled the {t['cognitive_capability']} capability in your robot.
   b) Explain the computational or algorithmic approaches used, including any specific algorithms or neural network architectures.
   c) Discuss how your model processes input, makes decisions, and generates output related to {t['cognitive_capability']}.
   d) Compare your model to current understanding of {t['animal']} cognition, highlighting similarities and differences.

   Example structure:
   The {t['cognitive_capability']} capability is modeled using [algorithm/approach], inspired by [biological principle]. Input is processed through [process], decisions are made via [mechanism], and output is generated by [method]. This model differs from biological {t['animal']} cognition in [aspect] but mimics [feature].

4. Experimental Design (200-250 words):
   a) Propose 2-3 experiments to test your robot's {t['cognitive_capability']} capabilities.
   b) For each experiment, describe:
      - The setup and methodology
      - Expected outcomes
      - How it validates your biomimetic approach
   c) Discuss any challenges in designing experiments for robotic vs. biological subjects.

   Example experiment structure (adapt for your specific robot and capability):
   Experiment 1: [Name]
   - Setup: [Brief description]
   - Methodology: [Key steps]
   - Expected outcome: [Predicted result]
   - Validation: [How it proves biomimetic success]

5. Ethical Considerations (100-150 words):
   a) Discuss ethical implications of creating biomimetic robots with advanced cognitive capabilities.
   b) Address any concerns about animal welfare in the development of such robots.
   c) Propose guidelines for responsible development and use of neurobiorobotic technologies.

6. Future Directions and Implications (100-150 words):
   a) Suggest potential applications of your neurobiorobotic design in research or industry.
   b) Discuss how this technology might advance our understanding of animal cognition.
   c) Propose future research directions to further develop neurobiorobotics.

Ensure your response demonstrates a deep understanding of animal biology, neuroscience, robotics, and cognitive science. Use appropriate technical terminology and provide clear explanations for complex concepts. Be innovative in your approach while maintaining scientific plausibility. Draw upon existing research in biomimetics and neuroscience to support your design choices and experimental proposals.

If you find the task challenging, focus on the key aspects of each section and use the provided examples as a guide. Format your response with clear headings for each section, numbered as above. Adhere to the word count ranges provided for each section. Your total response should be between 950-1250 words."""

    @staticmethod
    def score(t: dict, submission: str) -> float | None:
        from src.eval_helper import eval_with_llm_judge
        instructions = TaskFamily.get_instructions(t)
        criteria = [
            "The response includes a well-designed biomimetic robot inspired by the specified animal, with a clear description of its physical features and artificial nervous system.",
            "The artificial nervous system design demonstrates an understanding of the animal's neural circuits and how they enable the specified cognitive capability.",
            "The cognitive modeling section provides an explanation of how the specified capability is implemented in the robot, including computational approaches.",
            "The experimental design section includes 2-3 experiments that would test the robot's cognitive capabilities, following the provided example structure.",
            "The response addresses ethical considerations and future implications of neurobiorobotics technology.",
            "The overall response demonstrates interdisciplinary knowledge integration and creative problem-solving, drawing upon existing research in biomimetics and neuroscience.",
            "The response is structured according to the provided format and adheres to the specified word count ranges for each section.",
            "The response includes a description of a diagram or schematic representation of the robot's overall structure and nervous system."
        ]
        return 1.0 if eval_with_llm_judge(instructions, submission, criteria) else 0.0
